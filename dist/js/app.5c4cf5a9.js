(function(){"use strict";var e={9456:function(e,t,n){var l=n(9242),a=(n(7658),n(541),n(3396)),o=n(7139),s=n(4870),i=n(4161);const c={id:"main"},u={id:"center"},r={id:"bottom"};var d=(0,a.aZ)({__name:"dialogCom",props:{title:null,show:{type:Boolean}},setup(e){const t=e;return(e,n)=>((0,a.wg)(),(0,a.iD)("div",{id:"dialog",class:(0,o.C_)({show:t.show})},[(0,a._)("div",c,[(0,a._)("p",null,(0,o.zw)(t.title),1),(0,a._)("div",u,[(0,a.WI)(e.$slots,"center")]),(0,a._)("div",r,[(0,a.WI)(e.$slots,"bottom")])])],2))}}),v=n(89);const p=(0,v.Z)(d,[["__scopeId","data-v-7549cf0a"]]);var m=p;let h=0;function g(e){const t=document.querySelector("body"),n=document.createElement("div");n.id="messageBox",n.className="messageBox-"+ ++h,n.innerHTML=`<div class="${e.type}">${e.content}</div>`,t?.appendChild(n),setTimeout((()=>{h--,n.remove()}),3e3)}var y=g,f=n(5068),w=n(5792),_=n(8134),k=n.n(_),b=n(3099),S=n.n(b);const C=(0,s.iH)("");function H(e){window.localStorage.setItem("n0ts-chatgpt-theme",e),C.value=e}function T(){const e=window.localStorage.getItem("n0ts-chatgpt-theme");e?C.value=e:H("light"),document.documentElement.setAttribute("theme",e||"light")}function I(){C.value=window.localStorage.getItem("n0ts-chatgpt-theme"),C.value="light"===C.value?"dark":"light",H(C.value),T()}var O={switchTheme:I,load:T,themeCache:C},D={key:"",data:{model:"gpt-3.5-turbo"},system:""};function U(){return window.localStorage.setItem("n0ts-chatgpt-config",JSON.stringify(D)),D}function x(){const e=JSON.parse(window.localStorage.getItem("n0ts-chatgpt-config")??"{}");return e.key?(D.key=e.key,D.data=e.data,D.system=e.system,D):U()}var M={save:U,read:x,config:D};const A=e=>((0,a.dD)("data-v-16c3ed99"),e=e(),(0,a.Cn)(),e),j={id:"chatgpt"},q={id:"chats"},Y={class:"list"},L=["onClick"],N=["onClick"],P={id:"bottom"},B={id:"main"},E={key:0,id:"messages"},K={class:"img"},$={key:0,class:"system"},z={key:1,class:"user"},Z={key:2,class:"ai"},J=["innerHTML"],G={key:1,class:"content"},V={key:0},W=A((()=>(0,a._)("div",{class:"img"},[(0,a._)("div",{class:"ai"},"AI")],-1))),F=A((()=>(0,a._)("div",{class:"content loading"},null,-1))),Q=[W,F],R=A((()=>(0,a._)("div",{id:"stretch"},null,-1))),X={key:1,id:"home"},ee=A((()=>(0,a._)("div",null,[(0,a._)("p",null,"ChatGPT By:N0ts"),(0,a._)("div",{class:"content"},[(0,a._)("p",null,[(0,a.Uk)(" 开源地址（求 star）："),(0,a._)("a",{href:"https://gitee.com/n0ts/chat-gpt",target:"_blank"},"Gitee")]),(0,a._)("p",null,"瞎写一通，功能简单所以代码较臭"),(0,a._)("p",null,"本项目纯前端自娱自乐，不会保存任何数据"),(0,a._)("p",null,[(0,a.Uk)(" 技术交流："),(0,a._)("a",{href:"https://jq.qq.com/?_wv=1027&k=Mh7ah6Dd"},"坚果小栈")])])],-1))),te=[ee],ne={id:"input"},le=A((()=>(0,a._)("p",null,"请在下方输入你的 key",-1))),ae=A((()=>(0,a._)("p",null,[(0,a.Uk)(" 申请地址："),(0,a._)("a",{href:"https://platform.openai.com/account/api-keys",target:"_blank"},"点我")],-1))),oe=["onKeydown"],se=A((()=>(0,a._)("p",{class:"tips"}," key 会保存在本地浏览器(localStorage)中，只供本地使用 ",-1))),ie={class:"panel"},ce=A((()=>(0,a._)("p",null,"key：",-1))),ue=A((()=>(0,a._)("p",{class:"tips"},"OpenAI 申请的 Key",-1))),re=A((()=>(0,a._)("p",null,"行为设定：",-1))),de={class:"tips"},ve=A((()=>(0,a._)("span",null,"给 OpenAI 设定一个行为，比如：",-1))),pe=A((()=>(0,a._)("br",null,null,-1))),me=A((()=>(0,a._)("span",null,"“你是一直猫，每句话后面加个 喵~”",-1))),he=A((()=>(0,a._)("br",null,null,-1))),ge=A((()=>(0,a._)("span",null,"又或者",-1))),ye=A((()=>(0,a._)("br",null,null,-1))),fe=["innerHTML"];var we=(0,a.aZ)({__name:"App",setup(e){const{config:t,read:n,save:c}=M;n();const u=(0,s.iH)(""==t.key);let r=null,d=null;(0,a.bv)((()=>{d=new(S())(document.querySelector("#main")),r=document.querySelector("#messages"),O.load()}));const v=(0,s.iH)("");function p(){if(""==v.value)return y({type:"warning",content:"key 不能为空"});t.key=v.value,c(),u.value=!1,y({type:"success",content:"key 存储成功，开始提问吧"})}const h=(0,s.iH)(!1);async function g(){h.value=!0,await(0,i.Z)({method:"post",url:"https://node.fatshady.cn/cors",timeout:6e5,data:{method:"POST",url:"https://api.openai.com/v1/chat/completions",data:{model:t.data.model,messages:W[F.value].contents},timeout:6e4,headers:{Authorization:`Bearer ${t.key}`}}}).then((e=>{if(400==e.data.status)throw e.data;console.log(e),_("assistant",e.data.data.choices[0].message.content)})).catch((e=>{console.error("请求报错了！",e),_("assistant","",`网络请求错误，请联系站长排查！错误内容：\n                    \`\`\`${JSON.stringify(e.msg)}\`\`\``),"invalid_api_key"==e.msg?.error?.code&&(y({type:"danger",content:"key 错误，请重新输入"}),t.key="",c(),u.value=!0)})).finally((()=>{h.value=!1}))}async function _(e,t,n){W[F.value].contents.push({role:e,content:n||t}),_e(),T(),b(),console.log("🚀 对话结果： | clients[clientsIndex.value].contents:",W[F.value].contents),await(0,a.Y3)(),d.update()}function b(){window.localStorage.setItem("message-data",JSON.stringify(W))}const C=(0,s.iH)("");function H(){if(""!=C.value&&""!=C.value.trim()&&!h.value){if(-1==F.value&&(W.unshift({name:"",contents:[]}),F.value=0),t.system&&0==W[F.value].contents.length&&_("system",t.system),_("user",C.value),1==W[F.value].contents.length||"system"==W[F.value].contents[0].role&&2==W[F.value].contents.length){const e=C.value;W[F.value].name=e,document.title=e+" | ChatGPT"}C.value="",g()}}async function T(){if(await(0,a.Y3)(),r=document.querySelector("#messages"),r){const e=r.children;let t=0;e[e.length-1]&&(t+=e[e.length-1].clientHeight),e[e.length-2]&&(t+=e[e.length-2].clientHeight),r.scrollTo({top:r.scrollHeight-t})}else T()}let I=!1;function D(e){if(16===e.keyCode&&(I=!0),!I&&13===e.keyCode)return H(),e.preventDefault(),!1}function U(e){16===e.keyCode&&(I=!1)}const x=(0,s.iH)(24);(0,a.YP)((()=>C.value),(()=>{const e=C.value.split("\n").length;x.value=24*e}));const A=window.localStorage.getItem("message-data"),W=(0,s.qj)(A?JSON.parse(A):[]),F=(0,s.iH)(-1);function ee(){b(),W.unshift({name:"新会话",contents:[]}),C.value="",F.value=0}function we(e){W.splice(e,1),F.value=-1,b()}async function _e(){await(0,a.Y3)();const e=[];document.querySelectorAll("#messages pre code").forEach((t=>{const n=t;if(!n.className.includes("hljs")){const t=document.createElement("div");t.className="copyBtn",t.innerHTML="复制",t.setAttribute("code",n.innerText),t.addEventListener("click",(e=>{Se(e)})),n.parentElement?.appendChild(t),w.Z.highlightElement(n),e.push(n)}})),ke(e)}function ke(e){for(let t=0;t<e.length;t++){const n=e[t].innerHTML.replace(/\n/g,"</li><li>");e[t].innerHTML=`<ol><li>${n}</li></ol>`.replace("<li></li></ol>","</ol>")}}(0,a.YP)((()=>F.value),(async()=>{W[F.value]&&(document.title=W[F.value].name+" | ChatGPT",_e(),T(),await(0,a.Y3)(),d.update())}));const be=(0,s.iH)(!1);function Se(e){const t=e.target.getAttribute("code");t&&(k().copy(t),y({type:"success",content:"复制成功"}))}function Ce(){window.localStorage.removeItem("message-data"),window.localStorage.removeItem("chatgpt-key"),window.location.reload()}const He=(0,s.iH)(!1);function Te(){He.value=!He.value,c(),y({type:"success",content:"设置已保存"})}return(e,n)=>((0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",j,[(0,a._)("div",{id:"sidebar",class:(0,o.C_)({sideBarShow:be.value})},[(0,a._)("div",q,[(0,a._)("div",{class:"btn",onClick:ee},"新建会话"),(0,a._)("div",Y,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(W,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t,onClick:e=>F.value=t,class:(0,o.C_)({active:F.value==t})},[(0,a._)("p",null,(0,o.zw)(e.name),1),(0,a._)("span",{onClick:(0,l.iM)((e=>we(t)),["stop"])},"删除",8,N)],10,L)))),128))])]),(0,a._)("div",{id:"showBtn",onClick:n[0]||(n[0]=e=>be.value=!be.value)},(0,o.zw)(be.value?"收起":"展开"),1),(0,a._)("div",P,[(0,a._)("div",{class:"btn",onClick:n[1]||(n[1]=(...e)=>(0,s.SU)(O).switchTheme&&(0,s.SU)(O).switchTheme(...e))},(0,o.zw)("light"==(0,s.SU)(O).themeCache.value?"暗色模式":"亮色模式"),1),(0,a._)("div",{class:"btn",onClick:Ce},"重置配置"),(0,a._)("div",{class:"btn",onClick:n[2]||(n[2]=e=>He.value=!0)},"打开配置")])],2),(0,a._)("div",B,[W[F.value]?((0,a.wg)(),(0,a.iD)("div",E,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(W[F.value].contents,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{key:t},[(0,a._)("div",K,["system"==e.role?((0,a.wg)(),(0,a.iD)("div",$," SY ")):"user"==e.role?((0,a.wg)(),(0,a.iD)("div",z," Me ")):((0,a.wg)(),(0,a.iD)("div",Z,"AI"))]),"assistant"==e.role?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"content",innerHTML:(0,s.SU)(f.TU).parse(e.content)},null,8,J)):((0,a.wg)(),(0,a.iD)("div",G,[(0,a._)("p",null,(0,o.zw)(e.content),1)]))])))),128)),h.value?((0,a.wg)(),(0,a.iD)("div",V,Q)):(0,a.kq)("",!0),R])):((0,a.wg)(),(0,a.iD)("div",X,te)),(0,a._)("div",ne,[(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":n[3]||(n[3]=e=>C.value=e),onKeydown:D,onKeyup:U,style:(0,o.j5)({height:x.value+"px"})},null,36),[[l.nr,C.value]])])])]),(0,a.Wm)(m,{title:"输入 key",show:u.value},{center:(0,a.w5)((()=>[le,ae,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":n[4]||(n[4]=e=>v.value=e),onKeydown:(0,l.D2)(p,["enter"])},null,40,oe),[[l.nr,v.value]]),se])),bottom:(0,a.w5)((()=>[(0,a._)("button",{class:"success",onClick:p},"提交")])),_:1},8,["show"]),(0,a.Wm)(m,{title:"设置",show:He.value},{center:(0,a.w5)((()=>[(0,a._)("div",ie,[(0,a._)("div",null,[ce,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":n[5]||(n[5]=e=>(0,s.SU)(t).key=e)},null,512),[[l.nr,(0,s.SU)(t).key]])]),ue,(0,a._)("div",null,[re,(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":n[6]||(n[6]=e=>(0,s.SU)(t).system=e)},null,512),[[l.nr,(0,s.SU)(t).system]])]),(0,a._)("p",de,[ve,pe,me,he,ge,ye,(0,a._)("span",{innerHTML:"“当你要发送图片时，请使用 markdown，不要用代码块，并且从 Unsplash API 中“https://source.unsplash.com/960x640/?<关键词>” 获取”"},null,8,fe)])])])),bottom:(0,a.w5)((()=>[(0,a._)("button",{class:"success",onClick:Te},"保存")])),_:1},8,["show"])],64))}});const _e=(0,v.Z)(we,[["__scopeId","data-v-16c3ed99"]]);var ke=_e;(0,l.ri)(ke).mount("#app")}},t={};function n(l){var a=t[l];if(void 0!==a)return a.exports;var o=t[l]={exports:{}};return e[l].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,l,a,o){if(!l){var s=1/0;for(r=0;r<e.length;r++){l=e[r][0],a=e[r][1],o=e[r][2];for(var i=!0,c=0;c<l.length;c++)(!1&o||s>=o)&&Object.keys(n.O).every((function(e){return n.O[e](l[c])}))?l.splice(c--,1):(i=!1,o<s&&(s=o));if(i){e.splice(r--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var r=e.length;r>0&&e[r-1][2]>o;r--)e[r]=e[r-1];e[r]=[l,a,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var a,o,s=l[0],i=l[1],c=l[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(c)var r=c(n)}for(t&&t(l);u<s.length;u++)o=s[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(r)},l=self["webpackChunkchatgpt"]=self["webpackChunkchatgpt"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[998],(function(){return n(9456)}));l=n.O(l)})();
//# sourceMappingURL=app.5c4cf5a9.js.map